#
#   Configuration and settings for Knockout
#
banner: |
  // Knockout JavaScript library v<%= pkg.version %>
  // (c) Steven Sanderson - <%= pkg.homepage %>
  // License: <%= pkg.licenses[0].type %> (<%= pkg.licenses[0].url %>)

# Build scripts reside here
scriptsDir: build/fragments/

# knockout-latest[.debug].js goes here when compiled
buildDir: build/output/
build:
  main: knockout-latest.js
  debug: knockout-latest.debug.js
  headers:
  # This is from what was build/fragments/extern-pre.js:
  - |
    (function(undefined){
        // (0, eval)('this') is a robust way of getting a reference to the global object
        // For details, see http://stackoverflow.com/questions/14119988/return-this-0-evalthis/14120023#14120023
        var window = this || (0, eval)('this'),
            document = window['document'],
            navigator = window['navigator'],
            jQueryInstance = window["jQuery"],
            JSON = window["JSON"];


  # This is from what was build/fragments/amd-pre.js:
  - |
    (function(factory) {
        // Support three module loading scenarios
        if (typeof require === 'function' && typeof exports === 'object' && typeof module === 'object') {
            // [1] CommonJS/Node.js
            var target = module['exports'] || exports; // module.exports is for Node.js
            factory(target, require);
        } else if (typeof define === 'function' && define['amd']) {
            // [2] AMD anonymous module
            define(['exports', 'require'], factory);
        } else {
            // [3] No module loader (plain <script> tag) - put directly in global namespace
            factory(window['ko'] = {});
        }
    }(function(koExports, require){

  footers:
  # This is from what was build/fragments/amd-post.js:
  - |
    }));

  # This is from what was build/fragments/extern-post.js
  - |
    }());


# Created in tagged 'release' versions
distDir: dist/
dist:
  min: knockout.min.js
  debug: knockout.debug.js

# These are injected into runner.template.html to produce runner.*.html
JQUERY_JS: node_modules/jquery/dist/jquery.js
# In due course, when upgrading to Jasmine 2.0, the spec/helper/
# files could be replaced with node_modules/jasmine-core/lib/jasmine-core
JASMINE_JS: spec/helpers/lib/jasmine.js
JASMINE_HTML_JS: spec/helpers/lib/jasmine-html.js
JASMINE_CSS: spec/helpers/lib/jasmine.css
# When Modernizr finally makes it into npm it could perhaps be installed
# that way. It is also notably in grunt-modernizr.
MODERNIZR_JS: spec/helpers/lib/modernizr.js

# Added to runner[.modernizr|.jquery].html
AUTOGEN_WARNING:  AUTOGENERATED FROM spec/helpers/runner.template.html

# Files that have their 'version' bumped
PACKAGE_FILES:
  - ./package.json
  - ./bower.json

# Minifier
# uglify | closure
minifier: uglify

# Uglify options
uglify_options: {}

# Closure compiler
closure_options:
  compilation_level: ADVANCED_OPTIMIZATIONS
  output_wrapper: "(function() {%output%})();"

# Files that have their trailing spaces checked on lint
trailingSpaceSources:
  - 'spec/*.{js,html,css,bat,ps1,sh}'
  - 'src/*.{js,html,css,bat,ps1,sh}'
  - 'build/fragments/*'

# Listening for changes
livereload_port: 30397

# Source files
sources:
  - src/namespace.js
  - src/google-closure-compiler-utils.js
  - src/version.js
  - src/utils.js
  - src/utils.domData.js
  - src/utils.domNodeDisposal.js
  - src/utils.domManipulation.js
  - src/memoization.js
  - src/subscribables/extenders.js
  - src/subscribables/subscribable.js
  - src/subscribables/dependencyDetection.js
  - src/subscribables/observable.js
  - src/subscribables/observableArray.js
  - src/subscribables/observableArray.changeTracking.js
  - src/subscribables/dependentObservable.js
  - src/subscribables/mappingHelpers.js
  - src/binding/selectExtensions.js
  - src/binding/expressionRewriting.js
  - src/virtualElements.js
  - src/binding/bindingProvider.js
  - src/binding/bindingAttributeSyntax.js
  - src/components/loaderRegistry.js
  - src/components/defaultLoader.js
  - src/components/customElements.js
  - src/components/componentBinding.js
  - src/binding/defaultBindings/attr.js
  - src/binding/defaultBindings/checked.js
  - src/binding/defaultBindings/css.js
  - src/binding/defaultBindings/enableDisable.js
  - src/binding/defaultBindings/event.js
  - src/binding/defaultBindings/foreach.js
  - src/binding/defaultBindings/hasfocus.js
  - src/binding/defaultBindings/html.js
  - src/binding/defaultBindings/ifIfnotWith.js
  - src/binding/defaultBindings/options.js
  - src/binding/defaultBindings/selectedOptions.js
  - src/binding/defaultBindings/style.js
  - src/binding/defaultBindings/submit.js
  - src/binding/defaultBindings/text.js
  - src/binding/defaultBindings/textInput.js
  - src/binding/defaultBindings/uniqueName.js
  - src/binding/defaultBindings/value.js
  - src/binding/defaultBindings/visible.js
  # click depends on event - The order matters for specs, which includes each file individually
  - src/binding/defaultBindings/click.js
  - src/templating/templateEngine.js
  - src/templating/templateRewriting.js
  - src/templating/templateSources.js
  - src/templating/templating.js
  - src/binding/editDetection/compareArrays.js
  - src/binding/editDetection/arrayToDomNodeChildren.js
  - src/templating/native/nativeTemplateEngine.js
  - src/templating/jquery.tmpl/jqueryTmplTemplateEngine.js


# Test files -- Node
node_spec_files:
  - ./spec/helpers/beforeEach.js

  - ./spec/arrayEditDetectionBehaviors.js
  - ./spec/asyncBehaviors.js
  - ./spec/dependentObservableBehaviors.js
  - ./spec/pureComputedBehaviors.js
  - ./spec/expressionRewritingBehaviors.js
  - ./spec/extenderBehaviors.js
  - ./spec/mappingHelperBehaviors.js
  - ./spec/observableArrayBehaviors.js
  - ./spec/observableArrayChangeTrackingBehaviors.js
  - ./spec/observableBehaviors.js
  - ./spec/subscribableBehaviors.js
  - ./spec/utilsBehaviors.js

# Test files -- Phantom/etc
spec_files:
  - ./spec/arrayEditDetectionBehaviors.js
  - ./spec/arrayToDomEditDetectionBehaviors.js
  - ./spec/asyncBehaviors.js
  - ./spec/memoizationBehaviors.js
  - ./spec/subscribableBehaviors.js
  - ./spec/observableBehaviors.js
  - ./spec/observableArrayBehaviors.js
  - ./spec/observableArrayChangeTrackingBehaviors.js
  - ./spec/dependentObservableBehaviors.js
  - ./spec/pureComputedBehaviors.js
  - ./spec/dependentObservableDomBehaviors.js
  - ./spec/extenderBehaviors.js
  - ./spec/domNodeDisposalBehaviors.js
  - ./spec/mappingHelperBehaviors.js
  - ./spec/expressionRewritingBehaviors.js
  - ./spec/bindingPreprocessingBehaviors.js
  - ./spec/nodePreprocessingBehaviors.js
  - ./spec/bindingAttributeBehaviors.js
  - ./spec/bindingDependencyBehaviors.js
  - ./spec/templatingBehaviors.js
  - ./spec/jsonPostingBehaviors.js
  - ./spec/nativeTemplateEngineBehaviors.js
  - ./spec/utilsBehaviors.js

  - ./spec/defaultBindings/attrBehaviors.js
  - ./spec/defaultBindings/checkedBehaviors.js
  - ./spec/defaultBindings/clickBehaviors.js
  - ./spec/defaultBindings/cssBehaviors.js
  - ./spec/defaultBindings/enableDisableBehaviors.js
  - ./spec/defaultBindings/eventBehaviors.js
  - ./spec/defaultBindings/foreachBehaviors.js
  - ./spec/defaultBindings/hasfocusBehaviors.js
  - ./spec/defaultBindings/htmlBehaviors.js
  - ./spec/defaultBindings/ifBehaviors.js
  - ./spec/defaultBindings/ifnotBehaviors.js
  - ./spec/defaultBindings/optionsBehaviors.js
  - ./spec/defaultBindings/selectedOptionsBehaviors.js
  - ./spec/defaultBindings/styleBehaviors.js
  - ./spec/defaultBindings/submitBehaviors.js
  - ./spec/defaultBindings/textBehaviors.js
  - ./spec/defaultBindings/textInputBehaviors.js
  - ./spec/defaultBindings/uniqueNameBehaviors.js
  - ./spec/defaultBindings/valueBehaviors.js
  - ./spec/defaultBindings/visibleBehaviors.js
  - ./spec/defaultBindings/withBehaviors.js


#       TESTING
#
# How many concurrent browser streams?
test_streams: 3

# The listening port for our static file server.
server_port: 8081

# Check platforms available on SauceLabs:
# https://saucelabs.com/platforms
test_platforms:
  # Chrome
  - {platform: 'Windows 8', browserName: chrome, version: 35}
  - {platform: 'Windows 8', browserName: chrome, version: 36}
  - {platform: 'Windows 8', browserName: chrome, version: 37}
  - {platform: 'Windows 8', browserName: chrome, version: 38}
  
  # Firefox
  - {platform: 'Windows 8', browserName: firefox, version: 33}
  - {platform: 'Windows 8', browserName: firefox, version: 30}
  - {platform: 'Windows 8', browserName: firefox, version: 26}
  - {platform: Linux, browserName: firefox, version: 22}
  - {platform: Linux, browserName: firefox, version: 10}

  # Internet Explorer
  - {platform: 'Windows 8.1', browserName: 'internet explorer', version: 11}
  - {platform: 'Windows 8', browserName: 'internet explorer', version: 10}
  - {platform: 'Windows 7', browserName: 'internet explorer', version: 10}
  - {platform: 'Windows 7', browserName: 'internet explorer', version: 9}
  - {platform: 'Windows 7', browserName: 'internet explorer', version: 8}

  # Safari
  - {platform: 'OS X 10.9', browserName: safari, version: 7}
  - {platform: 'OS X 10.10', browserName: safari, version: 8}

  # Android
  - {platform: Linux, browserName: android, version: '4.4'}
  - {platform: Linux, browserName: android, version: '4.3'}
  - {platform: Linux, browserName: android, version: '4.2'}
  - {platform: Linux, browserName: android, version: '4.1'}
  - {platform: Linux, browserName: android, version: '4.0'}

  # iOS
  - {platform: 'OS X 10.9', browserName: iPhone, version: '8.1'}
  - {platform: 'OS X 10.9', browserName: iPhone, version: '7.1'}
  - {platform: 'OS X 10.8', browserName: iPhone, version: '6.1'}
  - {platform: 'OS X 10.8', browserName: iPhone, version: '5.1'}
  - {platform: 'OS X 10.6', browserName: iPhone, version: '4.3'}
